<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>Scan</title>
	<!-- Bootstrap -->
    <link href="./css/bootstrap.min.css" rel="stylesheet">

	<link rel="stylesheet" type="text/css" href="./css/style.css">

	<!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="./js/bootstrap.min.js"></script>
 	<script src="./js/jquery-2.1.4.js"></script>

	<script type='text/javascript'>
	$(function() {
  		$("#inputWord").bind("keypress", function (e) {
      		if (e.which == 13) enterPress($("#inputWord").val());
  		});
	});

	var resultList = [];
	function enterPress(result)
	{
		if (resultList.indexOf(result)==-1) 
		{
			// add
			var $log = $("#dvLog");
			$log.append(result + "<br/>");
			resultList.push(result);
		}
		else
		{
			// exit
			alert("資料重複!!");
		}
		$("#inputWord").val('');
		//alert("Enter:" + result);
		
	}

	var textFile = null
	makeTextFile = function (text) {
    	var data = new Blob([text], {type: 'text/plain'});

    	// If we are replacing a previously generated file we need to
    	// manually revoke the object URL to avoid memory leaks.
    	if (textFile !== null) {
      		window.URL.revokeObjectURL(textFile);
    	}

    	textFile = window.URL.createObjectURL(data);

    	return textFile;
  	};

	function save() {
		var data = "";
		for(var key in resultList){ 
			data += resultList[key] + "\r\n";
		}

		var link = document.getElementById('downloadlink');
    	link.href = makeTextFile(data);
    	link.style.display = 'block';
    	link.click();
	}
	
	

	</script>
</head>
<body>
<input type="text" id="inputWord" />
<input type="button" onclick="save()" value="儲存檔案" />
<a download="result.txt" id="downloadlink" style="display: none"></a>
<div id="dvLog"></div>



</body>
</html>